{"version":3,"file":"component---src-pages-getting-started-mdx-40f2a5a9dd91f72eb0e0.js","mappings":"wQAQaA,EAAe,CAAC,EACvBC,EAAc,CAClBD,aAAAA,GAEIE,EAAYC,EAAAA,EACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,GACF,YACD,OAAO,QAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,eAG5E,cACE,GAAM,kBACN,MAAS,CACP,SAAY,cAEb,aAAGC,WAAW,KACb,KAAQ,mBACR,aAAc,4BACd,UAAa,kBACZ,eAAKA,WAAW,IACf,cAAe,OACf,UAAa,QACb,OAAU,KACV,QAAW,MACX,QAAW,YACX,MAAS,OACR,gBAAMA,WAAW,MAChB,SAAY,UACZ,EAAK,oVAlBb,oBAoBA,4GACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,eADZ,8BAIL,8CACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,eADZ,qXAaL,wQACA,oGACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,eADZ,sCAIL,8CACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,eADZ,oGAIL,4JACA,sSACA,mJACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,sBADZ,kZAcL,wCAA0B,sBAAYA,WAAW,KAAvB,qBAA1B,qCAA4H,sBAAYA,WAAW,KAAvB,UAA5H,SAAuL,sBAAYA,WAAW,KAAvB,QAAvL,+JAAsY,aAAGA,WAAW,IAChZ,KAAQ,oDAD0X,mBAAtY,MAGA,qOACA,2NACA,oBAAK,gBAAMA,WAAW,MAClB,UAAa,eADZ,2HAIL,6JAGH,CAEDJ,EAAWK,gBAAiB,C,sBCrGb,SAASC,EAA8BC,EAAQC,GAC5D,GAAc,MAAVD,EAAgB,MAAO,CAAC,EAC5B,IAEIE,EAAKC,EAFLC,EAAS,CAAC,EACVC,EAAaC,OAAOC,KAAKP,GAG7B,IAAKG,EAAI,EAAGA,EAAIE,EAAWG,OAAQL,IACjCD,EAAMG,EAAWF,GACbF,EAASQ,QAAQP,IAAQ,IAC7BE,EAAOF,GAAOF,EAAOE,IAGvB,OAAOE,CACT,C","sources":["webpack://sanity-runner-docs/./src/pages/getting-started.mdx","webpack://sanity-runner-docs/../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/sanity-runner/sanity-runner/gatsby/src/components/Layout.tsx\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2 {...{\n      \"id\": \"getting-started\",\n      \"style\": {\n        \"position\": \"relative\"\n      }\n    }}><a parentName=\"h2\" {...{\n        \"href\": \"#getting-started\",\n        \"aria-label\": \"getting started permalink\",\n        \"className\": \"anchor before\"\n      }}><svg parentName=\"a\" {...{\n          \"aria-hidden\": \"true\",\n          \"focusable\": \"false\",\n          \"height\": \"16\",\n          \"version\": \"1.1\",\n          \"viewBox\": \"0 0 16 16\",\n          \"width\": \"16\"\n        }}><path parentName=\"svg\" {...{\n            \"fillRule\": \"evenodd\",\n            \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n          }}></path></svg></a>{`Getting Started`}</h2>\n    <p>{`Let's start by writing a basic sanity test. Create a directory to house your sanities:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`mkdir company-sanities\n`}</code></pre>\n    <p>{`Let's add a simple test:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`cat << EOF > company-sanities/google-search.test.js\ndescribe('Google Loads', () => {\n    test('Google Search is working', async () => {\n        await page.goto('https://www.google.com')\n        await expect(page).toFill('[title=Search]', 'Tophat\\\\n')\n        await page.waitFor(500)\n        await expect(page.url()).toContain('search')\n    }, 30000)\n})\nEOF\n`}</code></pre>\n    <p>{`Note that the test must be in JavaScript and cannot contain any imports. If you would like to import other files, you must bundle your tests using a tool such as webpack, esbuild, or rollup. There is also a limitation of 1 test case per file.`}</p>\n    <p>{`Once we have our test, let's test it out by running the sanity runner locally.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`yarn dlx sanity-runner-service\n`}</code></pre>\n    <p>{`and in another terminal:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`yarn dlx sanity-runner-client --test-dir company-sanities --local --output-dir artifacts -vv\n`}</code></pre>\n    <p>{`The sanity should run and print success or failure. A JUnit report will be written to the output directory specified (e.g. artifacts).`}</p>\n    <p>{`Running the sanity locally is great for testing, but if that's all there was to the sanity runner, we could just use Puppeteer or Playwright directly. Let's take it to the next level so we can quickly support running hundreds or even thousands of end to end browser tests.`}</p>\n    <p>{`In the sanity runner repository you will find a terraform module. In your own private infrastructure as code repository, add:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-terraform\"\n      }}>{`locals {\n    function_name = \"sanity-runner\"\n}\n\nmodule \"sanity-runner\" {\n  source                      = \"git@github.com:tophat/sanity-runner.git//terraform?ref=sanity-runner-terraform@1.0.0\"\n  function_name               = local.function_name\n  container_version           = \"latest\"\n  vpc_subnet_ids              = var.vpc_subnet_ids\n  vpc_sg_ids                  = var.vpc_sg_ids\n}\n`}</code></pre>\n    <p>{`You can change the `}<inlineCode parentName=\"p\">{`container_version`}</inlineCode>{` to point to a specific version, `}<inlineCode parentName=\"p\">{`latest`}</inlineCode>{`, or `}<inlineCode parentName=\"p\">{`next`}</inlineCode>{` (for pre-releases). It is recommended to hardcode the exact version. This version corresponds to the sanity-runner-service version, which you can find in `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/tophat/sanity-runner/releases\"\n      }}>{`GitHub Releases`}</a>{`.`}</p>\n    <p>{`Feel free to fork the terraform module if you'd like to customize the environment further. Most of the sanity runner logic lives in the client and service. The terraform module is maintained for convenience.`}</p>\n    <p>{`After deploying the infrastructure (which is just a simple Lambda), we can re-run the sanity-runner-client command but without the \"--local\" flag, and with the addition of the lambda function name:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sh\"\n      }}>{`yarn dlx sanity-runner-client --test-dir company-sanities --output-dir artifacts -vv --lambdaFunction sanity-runner\n`}</code></pre>\n    <p>{`This will invoke the lambda once per sanity test. You can specify concurrency limits for an upperbound on concurrent lambda invocations.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent","_objectWithoutPropertiesLoose","source","excluded","key","i","target","sourceKeys","Object","keys","length","indexOf"],"sourceRoot":""}