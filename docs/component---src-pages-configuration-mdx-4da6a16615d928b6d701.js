"use strict";(self.webpackChunksanity_runner_docs=self.webpackChunksanity_runner_docs||[]).push([[674],{3357:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return o},default:function(){return c}});var n=a(808),r=(a(7378),a(1368)),i=a(2912),l=["components"],o={},s={_frontmatter:o},d=i.Z;function c(e){var t=e.components,a=(0,n.Z)(e,l);return(0,r.kt)(d,Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"configuring-the-sanity-runner",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#configuring-the-sanity-runner","aria-label":"configuring the sanity runner permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Configuring the Sanity Runner"),(0,r.kt)("p",null,"For the client, you can run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"yarn dlx sanity-runner-client --help\n")),(0,r.kt)("p",null,"for a list of CLI options. Most options can also be passed in via a config file."),(0,r.kt)("h3",{id:"terraform-module",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#terraform-module","aria-label":"terraform module permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Terraform Module"),(0,r.kt)("h2",{id:"input-variables",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h2",href:"#input-variables","aria-label":"input variables permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Input Variables"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Variable"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Default Value"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"function_name")),(0,r.kt)("td",{parentName:"tr",align:"left"},'"sanity-runner"'),(0,r.kt)("td",{parentName:"tr",align:"left"},"Name for the lambda function deploys")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"container_version")),(0,r.kt)("td",{parentName:"tr",align:"left"},'"2.0.0"'),(0,r.kt)("td",{parentName:"tr",align:"left"},"Version of Service Container to deploy to the lambda (ghcr.io/tophat/sanity-runner-service)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"vpc_sg_ids")),(0,r.kt)("td",{parentName:"tr",align:"left"},"[]"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Security Group IDs to associate with lambda. Enables VPC mode. If used, requites vpc_subnet_ids to also be set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"vpc_subnet_ids")),(0,r.kt)("td",{parentName:"tr",align:"left"},"[]"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Subnet Ids to associate with the lambda. Enables VPC mode. If used, requites vpc_sg_ids to also be set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"memory_size")),(0,r.kt)("td",{parentName:"tr",align:"left"},"2048"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Memory_size for lambda")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"timeout")),(0,r.kt)("td",{parentName:"tr",align:"left"},"600"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sets Default timeout for lambda invocation")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"environment")),(0,r.kt)("td",{parentName:"tr",align:"left"},"{}"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sets additional env vars for the lambda")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"image_uri")),(0,r.kt)("td",{parentName:"tr",align:"left"},'""'),(0,r.kt)("td",{parentName:"tr",align:"left"},"Lets you set a custom image for the lambda")))),(0,r.kt)("h3",{id:"alerting",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h3",href:"#alerting","aria-label":"alerting permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Alerting"),(0,r.kt)("h4",{id:"slack",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h4",href:"#slack","aria-label":"slack permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"Slack"),(0,r.kt)("p",null,"For Slack alerting, you must provide a Slack API key in AWS Secret Manager with a name conforming to the pattern:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-raw"},"key: sanity_runner/slack_api_token\nsecret: slack_api_token\nvalue: <api token>\n")),(0,r.kt)("p",null,"When the Slack integration is enabled, the Slack channel and Slack team handle will be parsed from the docstring present in the failed sanity test. At the top of your sanity test file, add the docstring like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-raw"},"/**\n * @Slack #some-slack-channel\n * @SlackHandler @owning-team-handle\n * @Description\n *  - Instructions\n *  - for the team\n */\n")),(0,r.kt)("h4",{id:"pagerduty",style:{position:"relative"}},(0,r.kt)("a",{parentName:"h4",href:"#pagerduty","aria-label":"pagerduty permalink",className:"anchor before"},(0,r.kt)("svg",{parentName:"a","aria-hidden":"true",focusable:"false",height:"16",version:"1.1",viewBox:"0 0 16 16",width:"16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"}))),"PagerDuty"),(0,r.kt)("p",null,"For PagerDuty alerting, an ",(0,r.kt)("a",{parentName:"p",href:"https://developer.pagerduty.com/docs/events-api-v2/overview/"},"integration key")," is required. The key must be stored in AWS Secret Manager at:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-raw"},"key: sanity_runner/pagerduty_<name of pagerduty service>\nsecret: integration_key\nvalue: <integration key>\n")),(0,r.kt)("p",null,"Similar to Slack, you must specify the PagerDuty service via a docstring:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-raw"},"/**\n * @Pagerduty pagerduty-service\n * @Description\n *  - Instructions\n *  - for the team\n */\n")))}c.isMDXComponent=!0},808:function(e,t,a){function n(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}a.d(t,{Z:function(){return n}})}}]);
//# sourceMappingURL=component---src-pages-configuration-mdx-4da6a16615d928b6d701.js.map